<?php

namespace Tests\Unit\Commands\MySql;

use App\Models\Setting;
use App\Support\Console\DockerCompose\CliCommand;
use Tests\BaseTestCase;
use Tests\Unit\Support\Concerns\MocksDockerCompose;

class OpenTest extends BaseTestCase
{
    use MocksDockerCompose;

    public function remakePorter()
    {
        $this->mockDockerCompose();

        parent::remakePorter();
    }

    /** @test */
    public function it_runs_mysql()
    {
        Setting::updateOrCreate('use_mysql', 'on');

        $this->dockerCompose->shouldReceive('runContainer')
            ->andReturn($command = \Mockery::mock(CliCommand::class));

        $command->shouldReceive('append')->andReturn($command)
            ->shouldReceive('interactive')->andReturn($command)
            ->shouldReceive('perform');

        $this->artisan('mysql:open');
    }
}
